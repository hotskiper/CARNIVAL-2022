window.__require=function e(t,c,n){function o(i,a){if(!c[i]){if(!t[i]){var s=i.split("/");if(s=s[s.length-1],!t[s]){var h="function"==typeof __require&&__require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+i+"'")}}var d=c[i]={exports:{}};t[i][0].call(d.exports,function(e){return o(t[i][1][e]||e)},d,d.exports,e,t,c,n)}return c[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<n.length;i++)o(n[i]);return o}({backgroundLoader:[function(e,t,c){"use strict";cc._RF.push(t,"1ba569pWT1NW4FvgybtQ/YJ","backgroundLoader"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){Math.random();var e=this.node.getComponent(cc.Sprite);cc.loader.loadRes("hero/mainBg",cc.SpriteFrame,function(t,c){e.spriteFrame=c}),cc.log("mainBg")}}),cc._RF.pop()},{}],btn:[function(e,t,c){"use strict";cc._RF.push(t,"2da0dBTR9tDEoDKa8CshNX4","btn");var n=e("landMaker");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},buttonClicked:function(){n.restart()},gameStart:function(){cc.director.loadScene("MainGameScene")}}),cc._RF.pop()},{landMaker:"landMaker"}],gameOver:[function(e,t,c){"use strict";cc._RF.push(t,"4ebd46emCBFjYrWWW/Ap306","gameOver"),cc.Class({extends:cc.Component,properties:{scoreLabel:{default:null,type:cc.Label},scoreEarnLabel:{default:null,type:cc.Label},continueBtn:{default:null,type:cc.Node},logoutBtn:{default:null,type:cc.Node}},onLoad:function(){var e=parseInt(cc.sys.localStorage.getItem("score"));this.scoreLabel.string=e,this.scoreEarnLabel.string=0<=e&&e<2?1:2<=e&&e<5?4:5<=e&&e<8?7:8<=e&&e<11?10:11<=e&&e<14?12:14<=e&&e<17?14:17<=e&&e<20?16:20<=e&&e<25?18:20,this.continueBtn.on("touchstart",function(){cc.director.loadScene("MainGameScene")}),this.logoutBtn.on("touchstart",function(){window.history.go(-1)}),addScore(parseInt(this.scoreEarnLabel.string))}}),cc._RF.pop()},{}],landMaker:[function(e,t,c){"use strict";cc._RF.push(t,"d0079DKriBNl693joESFHLy","landMaker");var n,o=e("spriteCreator"),r=e("perfectLabel"),i=e("storageManager"),a=null;cc.Class({extends:cc.Component,properties:{landRange:cc.v2(20,300),landWidth:cc.v2(20,200),hero:cc.Node,firstLand:cc.Node,secondLand:cc.Node,moveDuration:.5,stickSpeed:400,heroMoveSpeed:400,stickWidth:14,canvas:cc.Node,scoreLabel:cc.Label,hightestScoreLabel:cc.Label,overLabel:cc.Label,perfectLabel:cc.Node,overMusic:{default:null,type:cc.AudioSource}},onLoad:function(){var e=this;n=new StateMachine({data:{gameDirector:null},init:"stand",transitions:[{name:"stickLengthen",from:"stand",to:"stickLengthened"},{name:"heroTick",from:"stickLengthened",to:"heroTicked"},{name:"stickFall",from:"heroTicked",to:"stickFalled"},{name:"heroMoveToLand",from:"stickFalled",to:"heroMovedToLand"},{name:"landMove",from:"heroMovedToLand",to:"stand"},{name:"heroMoveToStickEnd",from:"stickFalled",to:"heroMovedToStickEnd"},{name:"heroDown",from:"heroMovedToStickEnd",to:"heroDowned"},{name:"gameOver",from:"heroDowned",to:"end"},{name:"restart",from:"end",to:"stand"}],methods:{onLeaveHeroTicked:function(){a.unregisterEvent()},onStickLengthen:function(){a.stickLengthen=!0,a.stick=a.createStick(),a.stick.x=a.hero.x+a.hero.width*(1-a.hero.anchorX)+a.stick.width*a.stick.anchorX,a.hero.getComponent(cc.Animation).play("heroPush")},onHeroTick:function(){a.stickLengthen=!1;var e=a.hero.getComponent(cc.Animation);console.log("begin tick the stick and output the pos:",a.hero.x,a.hero.y),e.play("heroTick")},onStickFall:function(){var e=cc.rotateBy(.5,90);e.easing(cc.easeIn(3));var t=cc.callFunc(function(){var e=a.stick.height-a.stick.width*a.stick.anchorX;e<a.currentLandRange||e>a.currentLandRange+a.secondLand.width?n.heroMoveToStickEnd():(n.heroMoveToLand(),e>a.currentLandRange+a.secondLand.width/2-5&&e<a.currentLandRange+a.secondLand.width/2+5?(a.perfect++,a.getScore(a.perfect),a.perfectLabel.getComponent(r).showPerfect(a.perfect)):a.perfect=0)}),c=cc.sequence(e,t);a.stick.runAction(c)},onHeroMoveToLand:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun");var t=a.hero.getComponent(cc.Sprite);cc.loader.loadRes("hero/man",cc.SpriteFrame,function(e,c){t.spriteFrame=c}),a.getScore(),n.landMove()});e.play("heroRun"),a.heroMove(a.hero,{length:a.currentLandRange+a.secondLand.width,callFunc:t})},onLandMove:function(){var e=cc.callFunc(function(){a.registerEvent()});a.landCreateAndMove(e)},onHeroMoveToStickEnd:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun");var t=a.hero.getComponent(cc.Sprite);cc.loader.loadRes("hero/man",cc.SpriteFrame,function(e,c){t.spriteFrame=c}),n.heroDown()});e.play("heroRun"),a.heroMove(a.hero,{length:a.stick.height,callFunc:t})},onHeroDown:function(){e.overMusic.play();var t=cc.callFunc(function(){n.gameOver()});a.stickAndHeroDownAction(t)},onGameOver:function(){cc.director.preloadScene("GameoverScene",function(){cc.sys.localStorage.setItem("score",a.getLastScore()),cc.director.loadScene("GameoverScene")}.bind(this))},onRestart:function(){cc.director.loadScene("MainGameScene")}}}),a=this,this.runLength=0,this.stick=null,this.stickLengthen=!1,this.score=0,this.perfect=0,this.currentLandRange=0,this.heroWorldPosX=0,this.changeHightestScoreLabel(),this.createNewLand();var t=this.getLandRange();this.heroWorldPosX=this.firstLand.width-(1-this.hero.anchorX)*this.hero.width-this.stickWidth,this.secondLand.setPosition(t+this.firstLand.width,0),this.registerEvent(),a.hero.getComponent(cc.Animation).on("stop",function(e,t){"heroTick"==t.name&&(console.log("tick ani stop-------------",a.hero.x),n.stickFall())})},registerEvent:function(){this.canvas.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this),this.node),console.log("on")},unregisterEvent:function(){this.canvas.targetOff(this.node),console.log("off")},update:function(e){this.stickLengthen&&this.stick.height<=700&&(this.stick.height+=e*this.stickSpeed)},touchStart:function(e){n.stickLengthen(),cc.log("touchStart")},touchEnd:function(e){n.heroTick(),cc.log("touchEnd")},touchCancel:function(){this.touchEnd(),cc.log("touchCancel")},stickAndHeroDownAction:function(e){var t=cc.rotateBy(.5,90);t.easing(cc.easeIn(3)),this.stick.runAction(t);var c=cc.moveBy(.5,cc.v2(0,-300-this.hero.height));c.easing(cc.easeIn(3));var n=cc.sequence(c,e);this.hero.runAction(n)},heroMove:function(e,t){var c=t.length/this.heroMoveSpeed;console.log("hero move distance is ========================",t.length);var n=cc.moveBy(c,cc.v2(t.length,0));if(t.callFunc){console.log("this move has data.callFunc============",t.callFunc,t.length);var o=cc.sequence(n,t.callFunc);this.hero.runAction(o)}else this.hero.runAction(n)},landCreateAndMove:function(e){var t=cc.director.getWinSize(),c=this.currentLandRange+this.secondLand.width;this.runLength+=c;var n=cc.moveBy(this.moveDuration,cc.v2(-c,0));this.node.runAction(n),this.firstLand=this.secondLand,this.createNewLand();var o=this.getLandRange();this.secondLand.setPosition(this.runLength+t.width,0);var r=t.width-o-this.heroWorldPosX-this.hero.width*this.hero.anchorX-this.stickWidth,i=cc.moveBy(this.moveDuration,cc.v2(-r,0)),a=cc.sequence(i,e);this.secondLand.runAction(a)},createStick:function(){cc.log("sc");var e=o.createStick(this.stickWidth);return e.parent=this.node,e},createNewLand:function(){this.secondLand=o.createNewLand(this.getLandWidth()),this.secondLand.parent=this.node},getScore:function(e){return e?this.score+=e:this.score++,i.getHighestScore()<this.score&&(i.setHighestScore(this.score),this.changeHightestScoreLabel()),this.scoreLabel.string=this.score,this.score},getLastScore:function(){return this.score},changeHightestScoreLabel:function(){this.hightestScoreLabel.string="\u6700\u9ad8\u5206:"+i.getHighestScore()},getLandRange:function(){this.currentLandRange=this.landRange.x+(this.landRange.y-this.landRange.x)*Math.random();var e=cc.director.getWinSize();return e.width<this.currentLandRange+this.heroWorldPosX+this.hero.width+this.secondLand.width&&(this.currentLandRange=e.width-this.heroWorldPosX-this.hero.width-this.secondLand.width),this.currentLandRange},getLandWidth:function(){return this.landWidth.x+(this.landWidth.y-this.landWidth.x)*Math.random()}}),t.exports=n,cc._RF.pop()},{perfectLabel:"perfectLabel",spriteCreator:"spriteCreator",storageManager:"storageManager"}],perfectLabel:[function(e,t,c){"use strict";cc._RF.push(t,"68d3cmKQRxMxJwM5MfqZrPh","perfectLabel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.label=this.node.getComponent(cc.Label)},showPerfect:function(e){this.label.string="Perfect x"+e;var t=cc.fadeIn(.1),c=cc.moveBy(1,cc.p(0,0)),n=cc.fadeOut(0);cc.sequence(t,c,n)},removeLabel:function(){cc.log("removeLabel")},showLabel:function(){cc.log("showLabel")}}),cc._RF.pop()},{}],spriteCreator:[function(e,t,c){"use strict";cc._RF.push(t,"4310ceORutFCrUEBpToyuTd","spriteCreator");var n=function(){var e=null;return{createNewLand:function(t){var c=new cc.Node("Land");c.anchorX=0,c.anchorY=0;var n=c.addComponent(cc.Sprite);n.type=cc.Sprite.Type.SLICED,n.sizeMode=cc.Sprite.SizeMode.CUSTOM,cc.loader.loadRes("hero/land0",cc.SpriteFrame,function(e,t){n.spriteFrame=t}),c.height=300,c.width=t;var o=new cc.Node("Red Land");o.anchorY=1;var r=o.addComponent(cc.Sprite);return r.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.color=cc.Color.RED,o.parent=c,o.height=10,o.width=10,o.setPosition(c.width/2,c.height),e?r.spriteFrame=e:cc.loader.loadRes("hero/blank",cc.SpriteFrame,function(t,c){r.spriteFrame=c,e=c}),c.center=o,c},createStick:function(e){var t=new cc.Node("stick");t.anchorY=0,t.y=300;var c=t.addComponent(cc.Sprite);return c.type=cc.Sprite.Type.SLICED,c.sizeMode=cc.Sprite.SizeMode.CUSTOM,cc.loader.loadRes("hero/stick",cc.SpriteFrame,function(e,t){c.spriteFrame=t}),t.width=e,t.height=0,t}}}();t.exports=n,cc._RF.pop()},{}],startGame:[function(e,t,c){"use strict";cc._RF.push(t,"82fd1MByahHbbbKsfCCdIj1","startGame"),cc.Class({extends:cc.Component,properties:{startBtn:{default:null,type:cc.Node},help:{default:null,type:cc.Node},worldSceneBGM:{type:cc.AudioClip,default:null}},onLoad:function(){this.gameSceneBGMAudioId=cc.audioEngine.play(this.worldSceneBGM,!0,1);var e=this;cc.director.preloadScene("MainGameScene");var t=cc.scaleTo(.8,.9),c=cc.scaleTo(.8,1),n=cc.sequence(t,c),o=cc.repeatForever(n);this.startBtn.runAction(o),this.startBtn.on("touchstart",function(){e.help.active=!0}),this.help.on("touchstart",function(){cc.director.loadScene("MainGameScene")})}}),cc._RF.pop()},{}],storageManager:[function(e,t,c){"use strict";cc._RF.push(t,"10710Cz8ZRCqLlVtCy4fcaY","storageManager");var n=(cc.sys.localStorage.highestScore||(cc.sys.localStorage.highestScore=0),{getHighestScore:function(){return cc.sys.localStorage.highestScore},setHighestScore:function(e){cc.sys.localStorage.highestScore=e}});t.exports=n,cc._RF.pop()},{}]},{},["backgroundLoader","btn","gameOver","landMaker","perfectLabel","spriteCreator","startGame","storageManager"]);